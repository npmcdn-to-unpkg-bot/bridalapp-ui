


    CLIENT                              SERVER
    request protected resource --->
                                        is authenticated ?
                                            : YES (is authenticated)
                                                is authorized ?
                                                    : YES (is authorized)
														<--- protected resource
    --- (done) ---

                                                    : NO (NOT is authorized)
														<--- 403 Forbidden
    --- (done) ---

                                            : NO (NOT is authenticated)
												<--- 401 Unauthorized
    @LOGIN_CHALLENGE (failed)
    (open login dialog)
	failed ?
		: YES
			show message 'Login failed. Please try again.'
		: NO
			show message 'Please enter your credentials'
    (user enters credentials)
    ok / cancel ?
        : OK
            login (credentials) --->
												valid credentials ?
													: YES (valid credentials)
														is authorized ?
															: YES (is authorized)
																<--- protected resource
            @LOGGED_IN
            return protected resource
            --- (done) ---

                                                    : NO (NOT is authorized)
														<--- 403 Forbidden
            @LOGGED_IN
            return 403 Forbidden
            --- (done) ---

                                            : NO (NOT valid credentials)
												<--- 401 Unauthorized
            GOTO @LOGIN_CHALLENGE (FAILED)


        : CANCEL
            @CANCEL_LOGIN
            return 401 Unauthorized
            --- (done) ---
